<div class="container-scroller">
  <app-sidebar-prof></app-sidebar-prof>
  <div class="container-fluid page-body-wrapper">
    <app-navbar-prof></app-navbar-prof>
    <div class="main-panel">
      <div class="content-wrapper">

        <div class="d-flex justify-content-between align-items-center mb-4">
          <h5 class="card-title">Liste des Taches</h5>
          <div class="d-flex">

            <a class="nav-link btn btn-primary create-new-button"
              [routerLink]="['/dashboardProf', idProf, 'creerTache']">+ Creer Tache</a>

            <!--<a class="nav-link btn btn-primary create-new-button ml-3" [routerLink]="['/creerGroupe']">+ Créer
              Groupe</a>-->

          </div>
        </div>

        <div class="kanban-container d-flex justify-content-between">
          <div class="kanban-column">
            <h5>To Do</h5>
            <!--<div *ngFor="let tache of taches | filterByStatus:'todo'" class="card mb-3">-->
            <div *ngFor="let tache of taches" class="card mb-3" (click)="openTaskDetails(tache)">
              <div class="card-body">
                <span><h3 class="card-title">{{ tache.titre }}</h3><p class="card-text">{{ tache.description }}</p></span>
                <p class="card-text text-muted">{{ tache.dateLimite | date:'dd/MM/yyyy HH:mm' }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="task-modal" *ngIf="selectedTask">
  <div class="task-modal-content">
    <span class="close-btn" (click)="closeTaskDetails()">&times;</span>
    <h3 class="card-title">{{ selectedTask.titre }}</h3>
    <p class="card-text">{{ selectedTask.description }}</p>
    <p class="card-text text-muted">{{ selectedTask.dateLimite | date:'dd/MM/yyyy HH:mm' }}</p>
    <hr>
    <!-- show Comments -->
    <label>
      <h4>Commentaires</h4>
    </label>
    <div *ngFor="let c of selectedTask.completions">
      <div *ngFor="let comment of c.commentaires">{{comment}} -- {{c.etudiantName}}</div>
    </div>
    <hr>
    <!-- show Comments -->
    <h4 class="mb-0">Assigner à des étudiants</h4>
    <div class="form-group">
      <div *ngFor="let classe of tabClasses" class="form-check">
        <input type="checkbox" [value]="classe.id_Classe" (change)="onClasseChange(classe, $event)"
          class="form-check-input" id="classe-{{ classe.id_Classe }}" />
        <label class="form-check-label" for="classe-{{ classe.id_Classe }}">
          {{ classe.nom_Classe }} {{ classe.num_Classe }}
        </label>
      </div>
      <div *ngFor="let etudiant of etudiants" class="form-check">
        <input type="checkbox" [value]="etudiant.id_Etudiant" (change)="onEtudiantChange($event)"
          class="form-check-input" id="etudiant-{{ etudiant.id_Etudiant }}"
          [checked]="selectedEtudiants.includes(etudiant.id_Etudiant)" />
        <label class="form-check-label" for="etudiant-{{ etudiant.id_Etudiant }}">
          {{ etudiant.nom_Etd }} {{ etudiant.prenom_Etd }}
        </label>
      </div>
    </div>

    <div class="d-flex justify-content-end">
      <button class="btn btn-primary mr-2" (click)="assignSelectedEtudiants()"><i class="bi bi-plus-square"></i>
        Assigner</button>
    </div>
    <div *ngIf="alertVisible1" class="alert alert-primary mt-3" role="alert">Tâche assignée avec succès</div>
    <hr>
    <div class="d-flex justify-content-between mt-3">
      <button class="btn btn-light" [routerLink]="['/dashboardProf', idProf, 'taches', selectedTask.id_Tache]"><i
          class="bi bi-pencil-square"></i> Modifier</button>
      <button class="btn btn-danger"
        (click)="deleteTask(selectedTask.id_Tache, selectedTask.professeur.id_Professeur)"><i
          class="bi bi-trash-fill"></i> Supprimer</button>
    </div>


  </div>
</div>